
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <title>Questionnaire diab√©tologie - Pr√©-consultation</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f8f9fa;
      color: #333;
      padding: 30px;
      margin: 0;
    }
    .page {
      display: none;
      background: #ffffff;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(0,0,0,0.05);
      max-width: 800px;
      margin: auto;
    }
    .page.active {
      display: block;
    }
    .question {
      margin-bottom: 30px;
    }
    h2, h3 {
      color: #146C94;
    }
    input[type="text"], input[type="number"], select, textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      margin-top: 8px;
      font-size: 16px;
    }
    input[type="checkbox"] {
      margin-right: 8px;
    }
    button {
      background-color: #146C94;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      margin-right: 15px;
    }
    button:hover {
      background-color: #0f5a7d;
    }
    textarea {
      resize: vertical;
    }
    label {
      font-weight: bold;
      font-size: 17px;
    }
    .progress-container {
      width: 100%;
      background-color: #e0e0e0;
      border-radius: 10px;
      margin-bottom: 20px;
      height: 20px;
    }
    .progress-bar {
      height: 100%;
      background-color: #146C94;
      border-radius: 10px;
      width: 0%;
      transition: width 0.4s ease;
    }
  </style>
</head>
<body>
<div class="progress-container"><div class="progress-bar" id="progressBar"></div></div>
<h1>üìÑ Questionnaire de diab√©tologie - Pr√©-consultation</h1>

<div class="page active" id="page1">
  <div class="question"><label>Quel est votre nom ?</label><input id="nom" type="text"/></div>
  <div class="question"><label>Quel est votre √¢ge ?</label><input id="age" type="number"/></div>
  <div class="question"><label>Quel type de diab√®te avez-vous ?</label>
    <select id="diabeteType">
      <option value="Type 1">Type 1</option>
      <option value="Type 2">Type 2</option>
      <option value="Gestationnel">Gestationnel</option>
      <option value="Autres">Autres</option>
    </select>
  </div>
  <button onclick="changerPage(2)">Suivant</button>
</div>

<div class="page" id="page2">
  <div class="question">
    <label>üíâ Traitements injectables</label>
    <input id="chk_insuline_rapide" type="checkbox"/> Insuline rapide<br/>
    <input id="chk_insuline_lente" type="checkbox"/> Insuline lente<br/>
    <input id="chk_insuline_mixte" type="checkbox"/> Insuline mixte<br/>
    <input id="chk_glp1" type="checkbox"/> Analogue GLP-1<br/>
  </div>
  <div class="question">
    <label>üíä Traitements oraux</label>
    <input id="chk_biguanide" type="checkbox"/> Metformine<br/>
    <input id="chk_sulfamides" type="checkbox"/> Sulfamides<br/>
    <input id="chk_gliptines" type="checkbox"/> Gliptines<br/>
    <input id="chk_glifozines" type="checkbox"/> Glifozines<br/>
  </div>
  <button onclick="changerPage(1)">Pr√©c√©dent</button>
  <button onclick="changerPage(3)">Suivant</button>
</div>

<div class="page" id="page3">
  <div class="question"><label>üß† Correction non disponible sur cette version</label></div>
  <button onclick="changerPage(2)">Pr√©c√©dent</button>
  <button onclick="changerPage(4)">Suivant</button>
</div>

<div class="page" id="page4">
  <div class="question"><label>üòä √ätes-vous satisfait(e) de la prise en charge de votre diab√®te ?</label><br/>
  <textarea rows="3"></textarea></div>
  <div class="question"><label>ü§ù Est-ce que vous vous sentez bien suivi(e) par votre pharmacien ?</label><br/>
  <textarea rows="3"></textarea></div>
  <div class="question"><label>üü® Avez-vous assez de bo√Ætes DASRI ?</label><br/>
  <textarea rows="3"></textarea></div>
  <div class="question"><label>üó£Ô∏è Autres remarques :</label><br/>
  <textarea rows="3"></textarea></div>
  <button onclick="changerPage(5)">Suivant</button>
</div>

<div class="page" id="page5">
  <div class="question"><label>üõ†Ô∏è Suggestions pour am√©liorer ce questionnaire ?</label><br/>
  <textarea rows="4" style="width: 100%;"></textarea></div>
  <button onclick="changerPage(4)">Pr√©c√©dent</button>
  <button onclick="envoyerDonneesEtContinuer()">Suivant</button>
</div>

<div class="page" id="page6">
  <h2>üéâ Merci d'avoir compl√©t√© ce questionnaire</h2>
  <p>Vos r√©ponses ont bien √©t√© enregistr√©es.</p>
</div>

<script>
function changerPage(num) {
  document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
  document.getElementById("page" + num).classList.add("active");
  const pourcentage = Math.min((num - 1) / 5 * 100, 100);
  document.getElementById("progressBar").style.width = pourcentage + "%";
}

function envoyerDonneesEtContinuer() {
  const data = {
    nom: document.getElementById("nom")?.value || "",
    age: document.getElementById("age")?.value || "",
    type: document.getElementById("diabeteType")?.value || "",
    traitements: Array.from(document.querySelectorAll("input[type=checkbox]:checked")).map(e => e.nextSibling.textContent.trim()),
    satisfaction: document.querySelectorAll("textarea")[0]?.value || "",
    suivi: document.querySelectorAll("textarea")[1]?.value || "",
    dasri: document.querySelectorAll("textarea")[2]?.value || "",
    autres: document.querySelectorAll("textarea")[3]?.value || "",
    suggestions: document.querySelectorAll("textarea")[4]?.value || ""
  };

  try {
    fetch("https://script.google.com/macros/s/AKfycbw2NXKACNmOCRar6yA9o7xgL4qIGADpOv7YVDDTZV_jH57DheL62hmVAPXdJBlkucWjiw/exec", {
      method: "POST",
      mode: "no-cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });
  } catch (e) {
    console.error("Erreur envoi:", e);
  } finally {
    changerPage(6);
  }
}
</script>

<script>
function envoyerDonneesEtContinuer() {
  const data = {
    nom: document.getElementById("nom")?.value || "",
    age: document.getElementById("age")?.value || "",
    type: document.getElementById("diabeteType")?.value || "",
    traitements: Array.from(document.querySelectorAll("input[type=checkbox]:checked")).map(e => e.nextSibling.textContent.trim()),
    satisfaction: document.querySelectorAll("textarea")[0]?.value || "",
    suivi: document.querySelectorAll("textarea")[1]?.value || "",
    dasri: document.querySelectorAll("textarea")[2]?.value || "",
    autres: document.querySelectorAll("textarea")[3]?.value || "",
    suggestions: document.querySelectorAll("textarea")[4]?.value || ""
  };

  try {
    fetch("https://script.google.com/macros/s/AKfycbw2NXKACNmOCRar6yA9o7xgL4qIGADpOv7YVDDTZV_jH57DheL62hmVAPXdJBlkucWjiw/exec", {
      method: "POST",
      mode: "no-cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });
  } catch (e) {
    console.error("Erreur envoi:", e);
  } finally {
    changerPage(6);
  }
}
</script>
</body>
</html>

